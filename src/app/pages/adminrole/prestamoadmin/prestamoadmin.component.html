<div class="page-header">
    <h1 class="page-title">Prestamos Realizados</h1>
</div>

<div class="books-container">
    <!-- Barra de búsqueda -->
    <div class="search-container">
        <mat-form-field appearance="outline" class="search-field">
            <mat-label>Búsqueda</mat-label>
            <input matInput placeholder="Escribe aquí..." [(ngModel)]="searchText" (keyup)="applyFilter()" />
        </mat-form-field>

        <div class="radio-group">
            <label>
                <input type="radio" name="filter" value="title" [(ngModel)]="searchField" /> Título
            </label>
            <label>
                <input type="radio" name="filter" value="author" [(ngModel)]="searchField" /> Autor
            </label>
            <label>
                <input type="radio" name="filter" value="categoria" [(ngModel)]="searchField" /> Categoría
            </label>
            <label>
                <input type="radio" name="filter" value="returnAt" [(ngModel)]="searchField" /> Fecha Devolución 
            </label>
        </div>
    </div>

    <!-- Tabla -->
    <table mat-table [dataSource]="dataSource" class="mat-elevation-z8 book-table">
        <!-- ID LIBRO -->
        <ng-container matColumnDef="bookId">
            <th mat-header-cell *matHeaderCellDef> ID Libro </th>
            <td mat-cell *matCellDef="let prestamo"> {{ prestamo.bookId }} </td>
        </ng-container>

        <!-- Titulo -->
        <ng-container matColumnDef="title">
            <th mat-header-cell *matHeaderCellDef> Título </th>
            <td mat-cell *matCellDef="let prestamo"> {{ prestamo.title }} </td>
        </ng-container>

        <!-- Autor -->
        <ng-container matColumnDef="author">
            <th mat-header-cell *matHeaderCellDef> Autor </th>
            <td mat-cell *matCellDef="let prestamo"> {{ prestamo.author }} </td>
        </ng-container>

        <!-- Categoria -->
        <ng-container matColumnDef="categoria">
            <th mat-header-cell *matHeaderCellDef> Categoría </th>
            <td mat-cell *matCellDef="let prestamo"> {{ prestamo.categoria }} </td>
        </ng-container>

        <!-- Fecha Préstamo -->
        <ng-container matColumnDef="borrowedAt">
            <th mat-header-cell *matHeaderCellDef> Fecha Préstamo </th>
            <td mat-cell *matCellDef="let prestamo"> {{prestamo.borrowedAt | date:'short' }} </td>
        </ng-container>

        <!-- Fecha Devolución -->
        <ng-container matColumnDef="returnAt">
            <th mat-header-cell *matHeaderCellDef> Fecha Devolución </th>
            <td mat-cell *matCellDef="let prestamo"> {{ prestamo.returnAt | date:'short' }} </td>
        </ng-container>

        <!-- Estado -->
        <ng-container matColumnDef="estado">
            <th mat-header-cell *matHeaderCellDef> Estado Préstamo  </th>
            <td mat-cell *matCellDef="let prestamo"> {{ prestamo.estado ? 'Activo' : 'Inactivo'  }} </td>
        </ng-container>

        <!-- Estudiante -->
        <ng-container matColumnDef="studentName">
            <th mat-header-cell *matHeaderCellDef> Estudiante  </th>
            <td mat-cell *matCellDef="let prestamo"> {{ prestamo.student.names }} </td>
        </ng-container>

        <!-- Estudiante Email-->
        <ng-container matColumnDef="studentEmail">
            <th mat-header-cell *matHeaderCellDef> Correo  </th>
            <td mat-cell *matCellDef="let prestamo"> {{ prestamo.student.email }} </td>
        </ng-container>

        <!-- Estudiante studentidCard-->
        <ng-container matColumnDef="studentidCard">
            <th mat-header-cell *matHeaderCellDef> Cédula  </th>
            <td mat-cell *matCellDef="let prestamo"> {{ prestamo.student.idCard }} </td>
        </ng-container>

        <!-- Estudiante studentidCard-->
        <ng-container matColumnDef="studentphone">
            <th mat-header-cell *matHeaderCellDef> Télefono  </th>
            <td mat-cell *matCellDef="let prestamo"> {{ prestamo.student.phone }} </td>
        </ng-container>

        <!-- Acciones -->
        <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef> Acciones </th>
            <td mat-cell *matCellDef="let prestamo">
                <button mat-icon-button color="warn" (click)="deletePrestamo(prestamo.id)">
                    <mat-icon>delete</mat-icon>
                </button>
                <button mat-icon-button color="primary" (click)="cancelarPrestamo(prestamo.id, prestamo.bookId)">
                    <mat-icon>book</mat-icon>
                </button>
            </td>
        </ng-container>

        <!-- Encabezados y Filas -->
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
</div>